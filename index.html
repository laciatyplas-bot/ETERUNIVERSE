<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ETERNIVERSE MASTER HUB ‚Äî Architekt + Redaktor + Mapa</title>
  
  <!-- STYLES -->
  <style>
    /* ========================================
       MASTER HUB - Po≈ÇƒÖczenie wszystkich 3 aplikacji
       ======================================== */
    
    :root{
      /* Eterniverse Theme */
      --bg:#050814; 
      --card:#0A1727; 
      --card-soft:#0D1C30; 
      --text:#E9F4FF;
      --muted:#9BA9C8; 
      --border:#20324A; 
      --gold:#D9A441; 
      --teal:#28D3C6;
      --green:#12C65B; 
      --orange:#FFB14B; 
      --red:#FF6B6B; 
      --gray:#8B8FA0;
      
      /* Layout */
      --hub-height: 100vh;
      --panel-w: 350px;
      --tab-h: 48px;
    }
    
    *{box-sizing:border-box;margin:0;padding:0;}
    body{
      background: radial-gradient(circle at top, #15223A 0%, #050814 55%, #01030A 100%);
      color:var(--text); 
      font-family: system-ui, -apple-system, sans-serif; 
      height: 100vh;
      overflow: hidden;
    }
    
    /* === HUB LAYOUT === */
    .master-hub{
      height: var(--hub-height);
      display: grid;
      grid-template-columns: var(--panel-w) 1fr var(--panel-w);
      grid-template-rows: var(--tab-h) 1fr;
      grid-template-areas: 
        "tabs tabs tabs"
        "map editor structure";
      gap: 0;
    }
    
    /* === TABS === */
    .hub-tabs{
      grid-area: tabs;
      background: var(--card);
      border-bottom: 1px solid var(--border);
      display: flex;
      padding: 0 16px;
    }
    
    .tab-btn{
      flex: 1;
      padding: 12px;
      border: none;
      background: none;
      color: var(--muted);
      font-size: 13px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      transition: all 0.2s;
    }
    
    .tab-btn.active{
      color: var(--gold);
      border-bottom-color: var(--gold);
    }
    
    .tab-btn:hover:not(.active){
      color: var(--text);
      background: rgba(217,164,65,0.05);
    }
    
    /* === MAPA PANEL === */
    #mapa-panel{
      grid-area: map;
      background: var(--card);
      border-right: 1px solid var(--border);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    
    .panel-header{
      padding: 16px 20px;
      border-bottom: 1px solid var(--border);
      font-size: 14px;
      font-weight: 700;
      color: var(--gold);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    /* === STRUCTURE PANEL === */
    #structure-panel{
      grid-area: structure;
      background: var(--card);
      border-left: 1px solid var(--border);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    
    /* === EDITOR PANEL === */
    #editor-panel{
      grid-area: editor;
      background: var(--card-soft);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    
    .panel-content{
      flex: 1;
      overflow: auto;
      padding: 16px;
    }
    
    /* === MAPA ETERNIVERSE === */
    .map-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:12px; }
    .brama-card{ 
      background:var(--card-soft); 
      border-radius:12px; 
      border:1px solid var(--border); 
      padding:16px; 
      cursor:pointer;
      transition: all 0.2s;
    }
    .brama-card:hover{ border-color: var(--gold); transform: translateY(-2px); box-shadow: 0 8px 25px rgba(217,164,65,0.15); }
    .brama-title{ font-size:13px; font-weight:700; color:white; margin-bottom:6px; }
    .brama-sub{ font-size:11px; color:var(--muted); }
    .badge{ 
      font-size:8px; padding:3px 8px; border-radius:12px; 
      background:rgba(217,164,65,0.15); 
      color:var(--gold); 
      margin-top:8px; 
      display: inline-block;
    }
    
    /* === STRUCTURE HIERARCHY === */
    .hierarchy{ list-style:none; padding:0; }
    .hierarchy li{ 
      padding:10px 12px; 
      margin:4px 0; 
      border-radius:8px; 
      cursor:pointer;
      border-left:3px solid transparent;
      transition: all 0.2s;
    }
    .hierarchy li:hover{ background:var(--card-soft); border-left-color:var(--teal); }
    .hierarchy li.selected{ background:var(--gold); color:#000; border-left-color:#000; }
    .hierarchy li ul{ margin-left:16px; padding-left:8px; border-left:2px solid var(--teal); }
    
    /* === EDITOR === */
    .editor-toolbar{ 
      display:flex; gap:12px; margin-bottom:16px; padding-bottom:12px; 
      border-bottom:1px solid var(--border);
    }
    .editor-toolbar button{ 
      padding:8px 16px; border-radius:8px; border:1px solid var(--border); 
      background:var(--card); color:var(--text); font-size:12px; cursor:pointer;
    }
    .editor-toolbar button.active{ background:var(--gold); color:#000; }
    
    textarea{ 
      width:100%; height:100%; min-height:200px; 
      background:var(--card); border:1px solid var(--border); 
      border-radius:12px; padding:16px; 
      color:var(--text); font-size:14px; font-family:monospace;
      resize:vertical;
    }
    textarea:focus{ outline:none; border-color:var(--gold); box-shadow:0 0 0 3px rgba(217,164,65,0.1); }
    
    /* === MODALS === */
    .modal-backdrop{ 
      position:fixed; inset:0; background:rgba(0,0,0,0.92); 
      display:none; align-items:center; justify-content:center; 
      z-index:9999; padding:20px;
    }
    .modal{ 
      background:var(--card); border-radius:20px; border:2px solid var(--gold); 
      padding:32px; max-width:500px; width:100%; max-height:90vh; overflow:auto;
    }
    
    /* === UTILS === */
    .flex-gap{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
    .status-tag{ 
      font-size:10px; font-weight:800; padding:4px 8px; border-radius:6px; 
      text-transform:uppercase; letter-spacing:0.5px;
    }
    .status-wydane{ background:var(--green); color:#000; }
    .status-gotowe{ background:var(--gold); color:#000; }
    .status-trakcie{ background:var(--orange); color:#000; }
    
    /* === RESPONSIVE === */
    @media (max-width: 1200px){
      .master-hub{ grid-template-columns: 280px 1fr 280px; }
    }
    @media (max-width: 768px){
      .master-hub{ 
        grid-template-columns: 1fr;
        grid-template-areas: 
          "tabs"
          "map"
          "editor"
          "structure";
      }
    }
  </style>
</head>
<body>
  <div class="master-hub">
    <!-- TABS -->
    <div class="hub-tabs">
      <button class="tab-btn active" data-tab="mapa">üåå Mapa Eterniverse</button>
      <button class="tab-btn" data-tab="editor">‚úçÔ∏è Redaktor Bella</button>
      <button class="tab-btn" data-tab="structure">üèóÔ∏è Architektura</button>
    </div>
    
    <!-- MAPA ETERNIVERSE -->
    <div id="mapa-panel" class="panel">
      <div class="panel-header">
        <span>üåå MAPA ETERNIVERSE</span>
        <button onclick="openNewBookModal()">+ Nowa Ksiƒôga</button>
      </div>
      <div id="mapa-grid" class="panel-content map-grid"></div>
    </div>
    
    <!-- EDITOR BELLA -->
    <div id="editor-panel" class="panel">
      <div class="panel-header flex-gap">
        <span>‚úçÔ∏è BELLA REDAKTOR</span>
        <select id="profileSelect">
          <option value="amazon">Amazon</option>
          <option value="wattpad">Wattpad</option>
        </select>
      </div>
      <div class="editor-toolbar flex-gap">
        <button class="active" data-mode="content">Tre≈õƒá</button>
        <button data-mode="notes">Notatki</button>
        <button data-mode="console">Konsola</button>
      </div>
      <div class="panel-content">
        <textarea id="mainEditor" placeholder="Tre≈õƒá projektu / Notatki / Komendy..."></textarea>
      </div>
    </div>
    
    <!-- STRUCTURE -->
    <div id="structure-panel" class="panel">
      <div class="panel-header">
        <span>üèóÔ∏è HIERARCHIA UNIWERSUM</span>
        <button onclick="addUniverse()">+ Uniwersum</button>
      </div>
      <div id="structure-list" class="panel-content hierarchy"></div>
    </div>
  </div>
  
  <!-- MODAL NOWA KSIƒòGA -->
  <div class="modal-backdrop" id="newBookModal">
    <div class="modal">
      <h2>üåü Nowa Ksiƒôga</h2>
      <div class="flex-gap">
        <select id="modalGate"><option>BRAMA I ‚Äî INTERSEEKER</option></select>
        <input id="modalTitle" placeholder="Tytu≈Ç projektu">
      </div>
      <button class="btn-save" onclick="saveNewBook()" style="
        width:100%; margin-top:20px; padding:14px; background:var(--gold); 
        color:#000; font-weight:bold; border:none; border-radius:12px;
      ">‚ûï UTW√ìRZ KSIƒòGƒò</button>
    </div>
  </div>

  <script>
    /* ========================================
       MASTER HUB JAVASCRIPT - Wszystkie 3 aplikacje
       ======================================== */
    
    // === GLOBAL STATE ===
    const MAP_KEY = 'ETER_MASTER_MAP';
    const STRUCT_KEY = 'ETER_MASTER_STRUCT';
    let currentTab = 'mapa';
    let selectedStructureId = null;
    let editorMode = 'content';
    
    // === MAPA ETERNIVERSE DATA ===
    let mapaData = JSON.parse(localStorage.getItem(MAP_KEY)) || [
      {id:1, name:"BRAMA I ‚Äî INTERSEEKER", sub:"Psychika ¬∑ Cie≈Ñ ¬∑ Trauma", tag:"CORE/PSYCHE", books:[]},
      {id:2, name:"BRAMA II ‚Äî CUSTOS", sub:"Stra≈ºnik ¬∑ Rdze≈Ñ ¬∑ PoczƒÖtek", tag:"CORE/ORIGIN", books:[]},
      // ... (skr√≥cone dla przyk≈Çadu - dodaj pe≈Çne dane z poprzedniego)
    ];
    
    // === STRUCTURE DATA ===
    let structureData = JSON.parse(localStorage.getItem(STRUCT_KEY)) || [];
    
    // === INIT ===
    document.addEventListener('DOMContentLoaded', initHub);
    
    function initHub(){
      setupTabs();
      renderMapa();
      renderStructure();
      setupEditor();
    }
    
    /* === TABS SYSTEM === */
    function setupTabs(){
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.onclick = () => switchTab(btn.dataset.tab);
      });
    }
    
    function switchTab(tab){
      currentTab = tab;
      document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
      document.querySelector(`[data-tab="${tab}"]`).classList.add('active');
      
      // Hide/show panels
      document.querySelectorAll('.panel').forEach((p,i) => {
        p.style.display = ['mapa','editor','structure'][i] === tab ? 'flex' : 'none';
      });
    }
    
    /* === MAPA ETERNIVERSE === */
    function renderMapa(){
      const grid = document.getElementById('mapa-grid');
      grid.innerHTML = '';
      mapaData.forEach(brama => {
        const card = document.createElement('div');
        card.className = 'brama-card';
        card.innerHTML = `
          <div class="brama-title">${brama.name}</div>
          <div class="brama-sub">${brama.sub}</div>
          <span class="badge">${brama.tag}</span>
          <div style="margin-top:12px;font-size:11px;color:var(--muted);">
            ${brama.books.length} ksiƒÖg
          </div>
        `;
        card.onclick = () => selectBrama(brama.id);
        grid.appendChild(card);
      });
      saveMapa();
    }
    
    function selectBrama(id){
      const brama = mapaData.find(b => b.id === id);
      document.getElementById('mainEditor').value = 
        `=== ${brama.name} ===
${brama.sub}

` +
        (brama.books.length ? 
         brama.books.map(b => `üìñ ${b.title} [${b.status}]`).join('
') : 
         'Brak ksiƒÖg - dodaj nowƒÖ!'
        );
    }
    
    function openNewBookModal(){
      document.getElementById('newBookModal').style.display = 'flex';
    }
    
    function saveNewBook(){
      const title = document.getElementById('modalTitle').value.trim();
      if(!title) return alert('Podaj tytu≈Ç!');
      
      const gateId = parseInt(document.getElementById('modalGate').value);
      const brama = mapaData.find(b => b.id === gateId);
      brama.books.push({
        title,
        status: 'IDEA',
        created: new Date().toISOString()
      });
      
      document.getElementById('newBookModal').style.display = 'none';
      document.getElementById('modalTitle').value = '';
      renderMapa();
      selectBrama(gateId);
    }
    
    function saveMapa(){
      localStorage.setItem(MAP_KEY, JSON.stringify(mapaData));
    }
    
    /* === STRUCTURE === */
    function renderStructure(){
      const list = document.getElementById('structure-list');
      list.innerHTML = structureData.length ? 
        renderHierarchy(structureData) : 
        '<div style="text-align:center;color:var(--muted);padding:40px;">Brak uniwersum<br><button onclick="addUniverse()">‚ûï Stw√≥rz pierwsze</button></div>';
    }
    
    function renderHierarchy(items){
      return items.map(item => `
        <li onclick="selectStructure('${item.id}')" 
            class="${selectedStructureId === item.id ? 'selected' : ''}">
          üìÅ [${item.type}] ${item.title || 'Nowy'}
          ${item.children?.length ? `<ul>${renderHierarchy(item.children)}</ul>` : ''}
        </li>
      `).join('');
    }
    
    function addUniverse(){
      const newUniv = {
        id: 'u'+Date.now(),
        type: 'Uniwersum',
        title: 'Nowe Uniwersum',
        children: []
      };
      structureData.push(newUniv);
      selectedStructureId = newUniv.id;
      renderStructure();
      saveStructure();
    }
    
    function selectStructure(id){
      selectedStructureId = id;
      renderStructure();
      // Load to editor
      const item = findStructureItem(id);
      if(item) document.getElementById('mainEditor').value = item.content || '';
    }
    
    function findStructureItem(id, items = structureData){
      for(let item of items){
        if(item.id === id) return item;
        if(item.children) {
          const found = findStructureItem(id, item.children);
          if(found) return found;
        }
      }
    }
    
    function saveStructure(){
      localStorage.setItem(STRUCT_KEY, JSON.stringify(structureData));
    }
    
    /* === EDITOR === */
    function setupEditor(){
      // Toolbar
      document.querySelectorAll('.editor-toolbar button').forEach(btn => {
        btn.onclick = () => {
          document.querySelectorAll('.editor-toolbar button').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          editorMode = btn.dataset.mode;
        };
      });
      
      // Profile switch
      document.getElementById('profileSelect').onchange = (e) => {
        // Bella logic here
        console.log('Switched to profile:', e.target.value);
      };
    }
    
    /* === MODAL CONTROLS === */
    document.querySelector('.modal-backdrop').onclick = (e) => {
      if(e.target.classList.contains('modal-backdrop'))
        e.target.style.display = 'none';
    };
    
    /* === KEYBOARD SHORTCUTS === */
    document.addEventListener('keydown', (e) => {
      if(e.ctrlKey || e.metaKey){
        switch(e.key){
          case '1': switchTab('mapa'); break;
          case '2': switchTab('editor'); break;
          case '3': switchTab('structure'); break;
          case 'n': openNewBookModal(); break;
        }
      }
    });
  </script>
</body>
</html>